<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Chong-Chong He">
    <meta name="description" content="Chong-Chong He&#39;s personal website">
    <meta name="keywords" content="ChongChong,Chong-Chong,blog,personal,academic,website">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="Astro-statistics This Jupyter Notebook is adapted from the class notes of Cole Miller&rsquo;s graduate course Astrostatistics
import random from scipy import stats import numpy as np import matplotlib.pyplot as plt import seaborn as sns sns.set_style(&#39;darkgrid&#39;) SEED = 72 random.seed(SEED) np.random.seed(SEED) %matplotlib inline Central Limit Theorem Consider a uniform distribution from 0 to 1. This distribution has a mean value of 0.5 and a variance of $\sigma = 1/12$.
n = 1000 x = np."/>

    <meta property="og:title" content="" />
<meta property="og:description" content="Astro-statistics This Jupyter Notebook is adapted from the class notes of Cole Miller&rsquo;s graduate course Astrostatistics
import random from scipy import stats import numpy as np import matplotlib.pyplot as plt import seaborn as sns sns.set_style(&#39;darkgrid&#39;) SEED = 72 random.seed(SEED) np.random.seed(SEED) %matplotlib inline Central Limit Theorem Consider a uniform distribution from 0 to 1. This distribution has a mean value of 0.5 and a variance of $\sigma = 1/12$.
n = 1000 x = np." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chongchonghe.github.io/ttt/" />



    
      <base href="https://chongchonghe.github.io/ttt/">
    
    <title>
   · Chong-Chong He
</title>

    
      <link rel="canonical" href="https://chongchonghe.github.io/ttt/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="https://chongchonghe.github.io/css/coder.min.a4f332213a21ce8eb521670c614470c58923aaaf385e2a73982c31dd7642decb.css" integrity="sha256-pPMyITohzo61IWcMYURwxYkjqq84XipzmCwx3XZC3ss=" crossorigin="anonymous" media="screen" />
    

    

    
      
        
        
        <link rel="stylesheet" href="https://chongchonghe.github.io/css/coder-dark.min.83a2010dac9f59f943b3004cd6c4f230507ad036da635d3621401d42ec4e2835.css" integrity="sha256-g6IBDayfWflDswBM1sTyMFB60DbaY102IUAdQuxOKDU=" crossorigin="anonymous" media="screen" />
      
    

    
      <link rel="stylesheet" href="https://chongchonghe.github.io/css/custom.css" />
    

    

    

    <link rel="icon" type="image/png" href="https://chongchonghe.github.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://chongchonghe.github.io/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.65.3" />
  </head>

  
  
    
  
  <body class="colorscheme-auto">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://chongchonghe.github.io/">
      Chong-Chong He
    </a>
    
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://chongchonghe.github.io/about/">About</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://chongchonghe.github.io/research/">Research</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://chongchonghe.github.io/publications/">Publications</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://chongchonghe.github.io/gallery/">Gallery</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://chongchonghe.github.io/cche-cv.pdf">CV</a>
          </li>
        
      
      
        
        
        
          
        
          
            
              <li class="navigation-item menu-separator">
                <span>|</span>
              </li>
              
            
            <li class="navigation-item">
              <a href="https://chongchonghe.github.io/zh/">中文</a>
            </li>
          
        
      
    </ul>
    
  </section>
</nav>
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1></h1>
    </header>

    <h1 id="astro-statistics">Astro-statistics</h1>
<p>This Jupyter Notebook is adapted from the class notes of Cole Miller&rsquo;s graduate course Astrostatistics</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">import</span> random
<span style="color:#fff;font-weight:bold">from</span> scipy <span style="color:#fff;font-weight:bold">import</span> stats
<span style="color:#fff;font-weight:bold">import</span> numpy <span style="color:#fff;font-weight:bold">as</span> np
<span style="color:#fff;font-weight:bold">import</span> matplotlib.pyplot <span style="color:#fff;font-weight:bold">as</span> plt
<span style="color:#fff;font-weight:bold">import</span> seaborn <span style="color:#fff;font-weight:bold">as</span> sns
sns.set_style(<span style="color:#0ff;font-weight:bold">&#39;darkgrid&#39;</span>)

SEED = <span style="color:#ff0;font-weight:bold">72</span>
random.seed(SEED)
np.random.seed(SEED)

%matplotlib inline
</code></pre></div><h2 id="central-limit-theorem">Central Limit Theorem</h2>
<p>Consider a uniform distribution from 0 to 1. This distribution has a mean value of 0.5 and a variance of $\sigma = 1/12$.</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">n = <span style="color:#ff0;font-weight:bold">1000</span>
x = np.random.random(n)
plt.hist(x, bins=<span style="color:#ff0;font-weight:bold">10</span>, normed=True)
plt.axhline(<span style="color:#ff0;font-weight:bold">1</span>, ls=<span style="color:#0ff;font-weight:bold">&#39;--&#39;</span>, color=<span style="color:#0ff;font-weight:bold">&#39;r&#39;</span>)
plt.gca().set(xlabel=<span style="color:#0ff;font-weight:bold">&#39;x&#39;</span>, ylabel=<span style="color:#0ff;font-weight:bold">&#39;P&#39;</span>, title=<span style="color:#0ff;font-weight:bold">&#39;A random distribution&#39;</span>);
</code></pre></div><pre><code>/Users/chongchonghe/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py:3: MatplotlibDeprecationWarning: 
The 'normed' kwarg was deprecated in Matplotlib 2.1 and will be removed in 3.1. Use 'density' instead.
  This is separate from the ipykernel package so we can avoid doing imports until
</code></pre>
<p><img src="AstroStatistics_files/AstroStatistics_4_1.png" alt="png"></p>
<p>Now, consider a derived variable, y, which is the mean of $k = 10$ numbers from this distribution. Let&rsquo;s have a look at the distribution of y.</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">k = <span style="color:#ff0;font-weight:bold">10</span>
np.random.seed(SEED)
y = np.random.random([n, k])
y = np.mean(y, axis=<span style="color:#ff0;font-weight:bold">1</span>)
plt.hist(y, bins=<span style="color:#ff0;font-weight:bold">20</span>, density=True)
<span style="color:#007f7f"># plt.axvline(5, color=&#39;C0&#39;, ls=&#39;--&#39;, zorder=10)</span>
plt.gca().set(xlabel=<span style="color:#0ff;font-weight:bold">&#39;y&#39;</span>, ylabel=<span style="color:#0ff;font-weight:bold">&#39;P&#39;</span>, 
              title=<span style="color:#0ff;font-weight:bold">&#39;The distribution of the sum of {} random numbers&#39;</span>.format(k));
mu = <span style="color:#ff0;font-weight:bold">0.5</span>
var = <span style="color:#ff0;font-weight:bold">1</span>/<span style="color:#ff0;font-weight:bold">12</span>
mu2 = mu
var2 = var / k
xline = np.linspace(plt.xlim()[<span style="color:#ff0;font-weight:bold">0</span>], plt.xlim()[<span style="color:#ff0;font-weight:bold">1</span>], <span style="color:#ff0;font-weight:bold">100</span>)
<span style="color:#fff;font-weight:bold">def</span> gaussian(x, mu, sig):
    <span style="color:#fff;font-weight:bold">return</span> np.exp(-(x - mu)**<span style="color:#ff0;font-weight:bold">2.</span> / (<span style="color:#ff0;font-weight:bold">2</span> * sig**<span style="color:#ff0;font-weight:bold">2</span>)) / (sig * np.sqrt(<span style="color:#ff0;font-weight:bold">2</span> * np.pi))
yline = gaussian(xline, mu2, np.sqrt(var2))
plt.plot(xline, yline, <span style="color:#0ff;font-weight:bold">&#39;r--&#39;</span>, zorder=<span style="color:#ff0;font-weight:bold">20</span>, linewidth=<span style="color:#ff0;font-weight:bold">2</span>)
plt.text(<span style="color:#ff0;font-weight:bold">0.7</span>, <span style="color:#ff0;font-weight:bold">0.7</span>, <span style="color:#0ff;font-weight:bold">r</span><span style="color:#0ff;font-weight:bold">&#34;$N(\mu, \frac{{\sigma}}{{\sqrt{{k}}}})$&#34;</span>, fontsize=<span style="color:#0ff;font-weight:bold">&#39;x-large&#39;</span>,
        transform=plt.gca().transAxes, color=<span style="color:#0ff;font-weight:bold">&#39;r&#39;</span>)
plt.show()
</code></pre></div><p><img src="AstroStatistics_files/AstroStatistics_6_0.png" alt="png"></p>
<p>It&rsquo;s close to a Gaussian with a mean of 0.5 and variance of $\sigma^2/k$, shown as the dashed curve on top of the histogram. This is the <strong>Central Limit Theorem</strong>: when k independent random variables are drawn from any given distribution, their average tends toward a normal distribution with a mean $\mu$ and a variance of $\sigma^2/k$, where $\mu$ and $\sigma^2$ are the mean and variance of the original distribution.</p>
<!-- raw HTML omitted -->
<p>Let&rsquo;s check another example, a Poisson distribution</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">import</span> scipy
lam = <span style="color:#ff0;font-weight:bold">1.0</span>
np.random.seed(SEED)
x = np.random.poisson(lam, n)
plt.hist(x, bins=np.arange(-<span style="color:#ff0;font-weight:bold">0.5</span>, <span style="color:#ff0;font-weight:bold">8.5</span>, <span style="color:#ff0;font-weight:bold">1</span>), density=True)
xline = np.arange(<span style="color:#ff0;font-weight:bold">0</span>, <span style="color:#ff0;font-weight:bold">9</span>, <span style="color:#ff0;font-weight:bold">1</span>, dtype=<span style="color:#0ff;font-weight:bold">&#39;int&#39;</span>)
yline = lam**xline * np.exp(-lam) / scipy.special.factorial(xline)
plt.plot(xline, yline, <span style="color:#0ff;font-weight:bold">&#39;r--&#39;</span>)
plt.scatter(xline, yline, color=<span style="color:#0ff;font-weight:bold">&#39;r&#39;</span>, zorder=<span style="color:#ff0;font-weight:bold">10</span>)
plt.gca().set(xlabel=<span style="color:#0ff;font-weight:bold">&#39;x&#39;</span>, ylabel=<span style="color:#0ff;font-weight:bold">&#39;Counts&#39;</span>, title=<span style="color:#0ff;font-weight:bold">&#39;A Poisson distribution&#39;</span>);

plt.figure()
k = <span style="color:#ff0;font-weight:bold">100</span>
x = np.random.poisson(lam, k*n).reshape(n, k)
y = np.mean(x, axis=<span style="color:#ff0;font-weight:bold">1</span>)
plt.hist(y, bins=<span style="color:#ff0;font-weight:bold">20</span>, density=True)
mu2 = lam
var2 = lam / k
xline = np.linspace(plt.xlim()[<span style="color:#ff0;font-weight:bold">0</span>], plt.xlim()[<span style="color:#ff0;font-weight:bold">1</span>], <span style="color:#ff0;font-weight:bold">100</span>)
yline = gaussian(xline, mu2, np.sqrt(var2))
plt.plot(xline, yline, <span style="color:#0ff;font-weight:bold">&#39;r--&#39;</span>, zorder=<span style="color:#ff0;font-weight:bold">20</span>, linewidth=<span style="color:#ff0;font-weight:bold">2</span>)
plt.text(<span style="color:#ff0;font-weight:bold">0.6</span>, <span style="color:#ff0;font-weight:bold">0.7</span>, <span style="color:#0ff;font-weight:bold">r</span><span style="color:#0ff;font-weight:bold">&#34;$N(\mu, \frac{{\sigma}}{{\sqrt{{k}}}})$&#34;</span>, fontsize=<span style="color:#0ff;font-weight:bold">&#39;x-large&#39;</span>,
        transform=plt.gca().transAxes, color=<span style="color:#0ff;font-weight:bold">&#39;r&#39;</span>)

plt.figure()
plt.show()
</code></pre></div><p><img src="AstroStatistics_files/AstroStatistics_9_0.png" alt="png"></p>
<p><img src="AstroStatistics_files/AstroStatistics_9_1.png" alt="png"></p>
<pre><code>&lt;Figure size 432x288 with 0 Axes&gt;
</code></pre>

  </article>
</section>


      </div>

      <footer class="footer">
  <section class="container">
    
      <p>Last updated: Mar 8, 2020</p>
    
    
    
    
  </section>
</footer>

    </main>

    

    <script>
(function(f, a, t, h, o, m){
	a[h]=a[h]||function(){
		(a[h].q=a[h].q||[]).push(arguments)
	};
	o=f.createElement('script'),
	m=f.getElementsByTagName('script')[0];
	o.async=1; o.src=t; o.id='fathom-script';
	m.parentNode.insertBefore(o,m)
})(document, window, '//analytics.example.com/tracker.js', 'fathom');
fathom('set', 'siteId', 'ABCDE');
fathom('trackPageview');
</script>


  </body>

</html>
