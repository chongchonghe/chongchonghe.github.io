<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-04-08 Fri 16:45 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>&lrm;</title>
<meta name="generator" content="Org mode">
<meta name="author" content="ChongChong He">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<meta http-equiv='X-UA-Compatible' content='IE=edge'> <meta name='viewport' content='width=device-width, initial-scale=1'> <style type='text/css'> body { font-size: 20px; } img { max-width: 100%; } html,button,input,select,textarea {  color: black; /* #484C66; */}html {  font-size: 90%;  line-height: 1.4;}*,*:before,*:after {  -moz-box-sizing: border-box;  -webkit-box-sizing: border-box;  box-sizing: border-box;}a {  white-space: pre;  white-space: pre-wrap;  white-space: pre-line;  white-space: -pre-wrap;  white-space: -o-pre-wrap;  white-space: -moz-pre-wrap;  white-space: -hp-pre-wrap;  word-wrap: break-word;  text-decoration: none;}a:hover {  color: #0A4C89;}/* * Remove text-shadow in selection highlight: h5bp.com/i * These selection rule sets have to be separate. * Customize the background color to match your design. */::-moz-selection {  background: #0A4C89;  color: #FFF;  text-shadow: none;}::selection {  background: #0A4C89;  color: #FFF;  text-shadow: none;}/* * A better looking default horizontal rule */hr {  display: block;  height: 1px;  border: 0;  border-top: 1px dashed #CCC;  margin: 1em 0;  padding: 0;}/* * Remove the gap between images, videos, audio and canvas and the bottom of * their containers: h5bp.com/i/440 */audio,canvas,img,video {  vertical-align: middle;}/* * Remove default fieldset styles. */fieldset {  border: 0;  margin: 0;  padding: 0;}/* * Allow only vertical resizing of textareas. */textarea {  resize: vertical;}/* ==========================================================================   Author's custom styles   ========================================================================== */.todo,.done,.tag {  font-family: 'Source Pro', Monaco, 'Courier New', monospace;  padding: 0 0.3em;  background-color: #EEE;  border: 1px solid #CCC;}.todo {  color: #DD4433;}.done {  color: #44934B;}.tag {  font-size: 80%;  font-weight: normal;  margin: 0 0.3em;  display: none;}.timestamp {  color: #BEBEBE;}.timestamp-kwd {  color: #5F9EA0;}.right {  margin-left: auto;  margin-right: 0px;  text-align: right;}.left {  margin-left: 0px;  margin-right: auto;  text-align: left;}.center {  margin-left: auto;  margin-right: auto;  text-align: center;}.underline {  text-decoration: underline;}#postamble p,#preamble p {  font-size: 90%;  margin: .2em;}pre,code {  font-family: 'Source Pro', Monaco, 'Courier New', monospace;  padding-left: 0.3em;  padding-right: 0.3em;}pre {  font-size: 90%;  padding: 8pt;  overflow: auto;  white-space: pre;  word-wrap: normal;}pre.src {  position: relative;}pre.src:before {  display: none;  position: absolute;  background-color: #FFF;  top: 0.5em;  right: 0.5em;  padding: 4px;  border: 1px solid #CCC;}pre.src-sh:before {  content: 'Shell Script';}pre.src-bash:before {  content: 'Bash Script';}pre.src-emacs-lisp:before {  content: 'Emacs Lisp';}pre.src-R:before {  content: 'R';}pre.src-perl:before {  content: 'Perl';}pre.src-java:before {  content: 'Java';}pre.src-sql:before {  content: 'SQL';}pre.src-c:before {  content: 'C';}pre.src-cpp:before {  content: 'C++';}pre.src-html:before {  content: 'HTML';}table {  border-collapse: collapse;  display: block;  overflow-x: auto;}caption.t-above {  caption-side: top;}caption.t-bottom {  caption-side: bottom;}td, th {  vertical-align: top;  border: 1px solid #CCC;  padding: 0.5em;}th.right {  text-align: center;}th.left {  text-align: center;}th.center {  text-align: center;}td.right {  text-align: right;}td.left {  text-align: left;}td.center {  text-align: center;}dt {  font-weight: bold;}#footnotes {  border-top: 5px solid #0A4C89;  margin-bottom: 5em;}#footnotes h2 {  display: none;}#text-footnotes {  margin-top: 1em;}.footpara:nth-child(2) {  display: inline;}.footpara {  display: block;}.footdef sup:before {  content: '[';}.footdef sup:after {  content: ']';}.footdef p {  display: inline;}figure {  margin: 0;}figure img {  max-width: 100%;}figcaption {  text-align: center;  font-size: 0.8em;}.inlinetask {  padding: 10px;  border: 2px solid gray;  margin: 10px;  background: #ffffcc;}#org-div-home-and-up {  text-align: right;  font-size: 70%;  white-space: nowrap;}textarea {  overflow-x: auto;}.linenr {  font-size: smaller;}.code-highlighted {  background-color: #ffff00;}.org-info-js_info-navigation {  border-style: none;}#org-info-js_console-label {  font-size: 10px;  font-weight: bold;  white-space: nowrap;}.org-info-js_search-highlight {  background-color: #ffff00;  color: #000000;  font-weight: bold;}p.verse,blockquote {  margin: 0;  padding: 0;  padding-left: 3%;  border-left: 5px solid #0A4C89;}body {  font-family: Lora, Palatino, Georgia, serif;  width: 92%;  max-width: 1024px;  margin: 0 auto;  background-color: #FFF;}h2 {  line-height: 1.62em;}.title {  margin: 0 0 2em 0;  line-height: 2em;  border-bottom: 5px solid #0A4C89;  text-align: center;}#postamble {  font-size: 80%;  line-height: 1.4em;  text-align: right;}h1, h2, h3, h4, h5, h6 {  font-family: 'Source Sans Pro', sans-serif;  color: #222;}.outline-2 {  margin-bottom: 4em;}.outline-2 h2 {  border-bottom: 1px solid #CCC;}.outline-text-2 code, pre {  background-color: #EEE;}#table-of-contents {  display: none;  margin-left: 0.5em;}#text-table-of-contents ul {  padding-left: 1.8em;}#text-table-of-contents li {  list-style-type: circle;  margin: 0.4em 0;}#text-table-of-contents ul ul {  margin: 0;}#text-table-of-contents li li {  font-weight: normal;  font-size: 90%;  margin: 0;}#content {  overflow: hidden;  *zoom: 1;}/* ==========================================================================   EXAMPLE Media Queries for Responsive Design.   These examples override the primary ('mobile first') styles.   Modify as content requires.   ========================================================================== */@media only screen and (min-width: 35em) {  /* Style adjustments for viewports that meet the condition */}@media print, (-o-min-device-pixel-ratio: 5 / 4), (-webkit-min-device-pixel-ratio: 1.25), (min-resolution: 120dpi) {  /* Style adjustments for high resolution devices */}/* ==========================================================================   Print styles.   Inlined to avoid required HTTP connection: h5bp.com/r   ========================================================================== */@media print {  * {    background: transparent !important;    color: #000 !important;    /* Black prints faster: h5bp.com/s */    box-shadow: none !important;    text-shadow: none !important;  }  a,  a:visited {    text-decoration: underline;  }  a[href]:after {    content: ' (' attr(href) ')';  }  abbr[title]:after {    content: ' (' attr(title) ')';  }  /*   * Don't show links for images, or javascript/internal links   */  .ir a:after,  a[href^='javascript:']:after,  a[href^='#']:after {    content: '';  }  pre,  blockquote {    /* border: 1px solid #999; */    page-break-inside: avoid;  }  thead {    display: table-header-group;    /* h5bp.com/t */  }  tr,  img {    page-break-inside: avoid;  }  img {    max-width: 100% !important;  }  @page {    margin: 0.5cm;  }  p,  h2,  h3 {    orphans: 3;    widows: 3;  }  h2,  h3 {    page-break-after: avoid;  }  #table-of-contents {    display: block;    width: initial;    border: none;  }  #table-of-contents a {    text-decoration: none;  }}/* large screen */@media screen and (min-width: 40rem) {  html {    font-size: 100%;  }  #table-of-contents {    display: block;    padding: 1em;    width: 32%;    min-width: 18em;    float: right;    background-color: #EEE;    position: relative;    /* required by z-index */    z-index: 5000;    border: 1px solid #CCC;  }  .tag {    display: initial;  }} </style> 
<link rel='stylesheet' href='https://www.astro.umd.edu/~chongchong/html_styles/common/toc-left.css' type='text/css' />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div> <a accesskey='h' href='index.html'> UP </a> | <a accesskey='H' href='index.html'> HOME </a> </div><div id="content">
<nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org18b023c">1. Math</a>
<ul>
<li><a href="#orgd9a39d6">1.1. Statistics</a>
<ul>
<li><a href="#org0f1aca1">1.1.1. Basic probability and statistics</a></li>
<li><a href="#org952c0e3">1.1.2. Bayesian Statistics</a></li>
<li><a href="#org4f52c14">1.1.3. Two-point Correlation Function</a></li>
</ul>
</li>
<li><a href="#org64d283f">1.2. Fourier Transforms</a></li>
<li><a href="#sec:math">1.3. Fitting functions</a>
<ul>
<li><a href="#subsec:fermi">1.3.1. ArcTan and Sigmoid function</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</nav>
<div id="outline-container-org18b023c" class="outline-2">
<h2 id="org18b023c"><span class="section-number-2">1</span> Math</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgd9a39d6" class="outline-3">
<h3 id="orgd9a39d6"><span class="section-number-3">1.1</span> Statistics</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org0f1aca1" class="outline-4">
<h4 id="org0f1aca1"><span class="section-number-4">1.1.1</span> Basic probability and statistics</h4>
<div class="outline-text-4" id="text-1-1-1">
</div>
<ol class="org-ol">
<li><a id="orgc07ba68"></a>Central limit theorem<br>
<div class="outline-text-5" id="text-1-1-1-1">
<p>
Using the following code, I showed that the number of head-up coins of 100 flipping followes the following distribution: N(50, sigma<sup>2</sup>) and sigma = 5. I will work out the math.
</p>

<div class="org-src-container">
<pre class="src src-python">N = 10000
a = np.random.choice([0, 1], [N, 100])
count = np.sum(a, axis=1)
# bins = np.linspace(0, 100, 50)
# n, _ = np.histogram(count, bins=bins)
from scipy.stats import norm
mu, std = norm.fit(count)
</pre>
</div>
</div>
</li>
</ol>
</div>


<div id="outline-container-org952c0e3" class="outline-4">
<h4 id="org952c0e3"><span class="section-number-4">1.1.2</span> Bayesian Statistics</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
Here I describe the very basics of Bayes inference with some examples.
Here's an article about
<a href="http://jakevdp.github.io/blog/2014/06/14/frequentism-and-bayesianism-4-bayesian-in-python/">How
to be a Bayesian in Python</a>, which introduces the Python MCMC package:
<a href="http://dfm.io/emcee/current/">emcee</a>.
</p>
</div>

<ol class="org-ol">
<li><a id="orga379405"></a>Bayes' Theorem<br>
<div class="outline-text-5" id="text-1-1-2-1">
<p>
\[P(A|B) = \frac{P(B|A)P(A)}{P(B)},
  \label{eq:bayes}\] where Bayesian interpretations of the factors in
this equation are:
</p>

<ul class="org-ul">
<li>\(P(A|B)\) is the probability of the hypothesis given the dat and prior
information.</li>

<li>\(P(B|A)\) is the probability that the data would be observed if the
hypothesis were true.</li>

<li>\(P(A)\) is the prior probability of the hypothesis being true (in other
words, the probability you assigned to the hypothesis before you took
the data).</li>

<li>\(P(B)\) can be considered as a normalizing constant, given that
probabilities must integrate to unity.</li>
</ul>
</div>
</li>

<li><a id="orgd773569"></a>Parameter Estimation, Discrete Distributions<br>
<div class="outline-text-5" id="text-1-1-2-2">
<p>
First consider the discrete case. In a particular model, you expect
there to be \(m_i\) counts in bin \(i\). Then, the probability of actually
observing \(d_i\) counts in bin \(i\) of the data, given the model is
correct, is, from the Poisson distribution,
\[{\cal L}_i = \frac{m_i^{d_i}}{d_i!} e^{-m_i}.
  \label{eq:L}\]
</p>

<p>
In the limit of Gaussian statistics, the probability of the data given
the model in bin \(i\), \(p_i\), is given by
\[p_i = \frac{1}{\sigma_i \sqrt{2\pi}} e^{-(d_i - m_i)^2 / 2\sigma_i^2}.
  \label{eq:pi}\] Wilks' theorem tells us that
\(2\Delta \ln {\cal L} = - \Delta \chi^2\) in the Gaussian limit.
\(1\sigma\) range would be \(\Delta \chi^2 = 1\), which corresponds to
\(\Delta \ln {\cal L} = -0.5\) around the maximum.
</p>
</div>
</li>

<li><a id="org861c289"></a>Parameter Estimation, Continuous Distributions<br>
<div class="outline-text-5" id="text-1-1-2-3">
<p>
The probability of a data is simplily the probability distribution
function (PDF): \(dP = N(x) \mathop{}\!\mathrm{d}x\), and the log
posterior probability \(\ln {\cal L} =
\Sigma \ln N(x_i)\) + const, where \(x_i\) is the observed data.
</p>
</div>
</li>

<li><a id="org95d447a"></a>Nuisance Parameters: Marginalization<br>
<div class="outline-text-5" id="text-1-1-2-4">
<p>
Given a posterio probability distribution \(P(a_1, a_2, \cdots, a_n)\),
normalized so that<br>
\(\int P(a_{1}, a_{2}, \cdots, a_{n}) da_1 da_2 \cdots da_n=1\). To get
the probability distribution for parameter \(a_1\), independent of the
values of the other parameters, we integrate over those other
parameters:
\[p(a_1) = \int P(a_1, a_2, \cdots, a_n) \mathop{}\!\mathrm{d}a_2 \cdots \mathop{}\!\mathrm{d}a_n.
  \label{eq:margin}\]
</p>
</div>
</li>

<li><a id="orgef03125"></a>Model Comparison<br>
<div class="outline-text-5" id="text-1-1-2-5">
<p>
"Bayes factor".
</p>
</div>
</li>

<li><a id="org7e2e013"></a>Example: Fitting a Straight Line to Data<br>
<div class="outline-text-5" id="text-1-1-2-6">
<p>
Assume a fitting to the data \[y = \beta_0 + \beta_1 \, x. \label{eq:y}\] If we assume that each data point departs from the staright line by an amount \(\epsilon_i\) which as a \(\mathcal{N}(0,\sigma^2)\) distribution, and \(\sigma\) is known, i.e.,
</p>

<p>
\[y_i \sim {\cal N} (\beta_0 + \beta_1 x_i, \sigma^2),
  \label{eq:yi}\]
</p>

<p>
then, the posterior distribution for \(\beta_0\) and \(\beta_1\) is proportional to the product of the \(N\) normal densities:
</p>

<p>
\[P(\beta_0,\beta_1|{y_1,y_2,\cdots,y_N}) \propto \prod_{i=1}^{N} \exp \left[
  -\frac{(y_i-(\beta_0+\beta_1 x_i))^2}{2\sigma^2} \right].
  \label{eq:pbeta}\]
</p>

<p>
In practice, we set the prior as \(p(\theta, b) = p(\theta)p(b)\), where \(p(\theta) = 1/\pi\) from \(\theta=0\) to \(\theta = \pi\) and 0 otherwise, and \(p(b) = 1/(b_2 - b_1)\) from \(b=b_1\) to \(b=b_2\) and 0 otherwise. Then,
</p>

<p>
\[P(\theta, b) \propto \frac{1}{\pi} \frac{1}{b_2 - b_1} \prod_{i=1}^{N} \exp \left[ -\frac{(y_i-(\beta_0+\beta_1 x_i))^2}{2\sigma^2} \right]. \label{eq:pbeta2}\]
</p>

<p>
For data with uncertainties, \(\sigma\) may be replaced with \(\sigma_i\), the reported Gaussian uncertainty in the $i$th measurement of x. Note that the log of the product is \(- \chi^2/2\). We then normalize the posterior probability density such that
</p>

<p>
\[\int_0^\pi \int_{b_1}^{b_2} P(\theta, b) \mathop{}\!\mathrm{d}b \mathop{}\!\mathrm{d}\theta = 1. \label{eq:norm}\]
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org4f52c14" class="outline-4">
<h4 id="org4f52c14"><span class="section-number-4">1.1.3</span> Two-point Correlation Function</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
<a href="http://www.astro.lu.se/Education/utb/ASTM21/ASTM21-P1.pdf">This pdf document</a> (or <a href="file:///Users/chongchonghe/Academics/Books-more/Astrophysics/StarsStarClusters/ASTM21-P1.pdf">local</a>) introduces the theories of two-point correlation function with references. Python has a package to do pair counting.
</p>
</div>

<ol class="org-ol">
<li><a id="org5e4a14e"></a>Definition<br>
<div class="outline-text-5" id="text-1-1-3-1">
<p>
In order to quantify the clustering of galaxies, one must survey the entire galaxy distribution, from voids to superclusters. The most commonly used quantitative measure of large scale structure is the galaxy two-point correlation function, which is the amplitude of galaxy clustering as a function of scale. The two-point correlation function, \(\xi(r)\), is defined as a measure of the excess probability above what is expected for an unclustered random Poisson distribution, of finding a galaxy in a volume element \(dV\) at a separation \(r\) from another galaxy,
</p>

<p>
\[ dP = [1 + \xi(r)] n dV, \]
</p>
</div>
</li>

<li><a id="org03f974c"></a>Estimators<br>
<div class="outline-text-5" id="text-1-1-3-2">
<p>
The dataset (\(D\)) under investigation contains \(n\) points. The two-point correlation function is obtained by comparing the distribution of separations in \(D\) with that in a random set, called \(R\), which contains \(r\) points. In the interval \(x\) to \(x + \delta x\), count the number of pairs in \(D\) and \(R\) and denote them as \(N_D\) and \(N_R\), respectively. The 'natural' estimator of \(w(x)\) is
</p>

<p>
\[w_1 = \frac{\frac{N_D}{n(n-1)/2} - \frac{N_R}{r(r-1)/2}}{\frac{N_R}{r(r-1)/2}} = \frac{r(r-1)}{n(n-1)} \frac{N_D}{N_R} - 1 \approx \frac{r^2}{n^2} \frac{N_D}{N_R} - 1.\]
</p>

<p>
Landy &amp; Szalay suggested a much better estimate by using also the cross-correlation statistic \(N_{DR}\), which is the number of pairs in the seperation interval, with one point taken from \(D\) and the other from \(R\). \[w_3 \approx \frac{N_D/n^2 - 2N_{DR}/nr + N_R/r^2}{N_R/r^2} = \frac{r^2 N_D}{n^2 N_R} - \frac{r N_{DR}}{n N_{R}} + 1.\]
</p>
</div>
</li>

<li><a id="orgcc57e0d"></a>Analytical Calculation of the Random Field<br>
<div class="outline-text-5" id="text-1-1-3-3">
<p>
I propose to use a general analytical expression to account for Input
</p>

<pre class="example" id="orgb46e45e">
Integrate[x ArcCos[(x^2 + r^2 - R^2)/(2 x r)], x]
</pre>

<p>
Output
</p>

<pre class="example" id="orge489e74">
1/4 x (-r Sqrt[-((r^4 + (R^2 - x^2)^2 - 2 r^2 (R^2 + x^2))/(
     r^2 x^2))] + 2 x ArcCos[(r^2 - R^2 + x^2)/(2 r x)]) - (
r R^2 x Sqrt[-((r^4 + (R^2 - x^2)^2 - 2 r^2 (R^2 + x^2))/(r^2 x^2))]
  ArcTan[(r^2 + R^2 - x^2)/
  Sqrt[-r^4 - (R^2 - x^2)^2 + 2 r^2 (R^2 + x^2)]])/(
2 Sqrt[-r^4 - (R^2 - x^2)^2 + 2 r^2 (R^2 + x^2)])
</pre>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org64d283f" class="outline-3">
<h3 id="org64d283f"><span class="section-number-3">1.2</span> Fourier Transforms</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Define the Fourier transformation \[\label{eq:fourier1}
F(\omega) = \int_{-\infty}^{+\infty} e^{-i\omega\tau} f(\tau) \mathop{}\!\mathrm{d}\tau,\]
and the inverse transformation that relates \(f(t)\) to \(F(\tau)\),
\[\label{eq:6}
f(t) = \frac{1}{2\pi} \int_{-\infty}^{+\infty} e^{i \omega t}
F(\omega) \mathop{}\!\mathrm{d}\omega.\] Note that \(f(\tau)\) is usually
a real function. Physicists prefer the following form for convenience:
</p>

<p>
\[\begin{aligned}
\Phi(p) &= \int_{-\infty}^{+\infty} F(x) e^{-2\pi i p x} \mathop{}\!\mathrm{d}x,\\
F(x) &= \int_{-\infty}^{+\infty} \Phi(p) e^{2\pi i x p} \mathop{}\!\mathrm{d}p.
\label{eq:fourier2}\end{aligned}\]
</p>

<p>
Some popular pairs of conjugate variables, \(x\) and \(p\), are 1) time \(t\)
and frequency \(\nu\), in accoustics and radio; 2) position \(x\) and
momentum divided by Planck's constant \(p/\hbar\) in quantum mechanics; 3)
aperture \(x\) and diffraction angle divied by wavelength \(\sin
\theta/\lambda\) in diffraction theory.
</p>

<p>
I list the Fourier Transforms of some of the commonly used functions in
</p>
</div>

<ol class="org-ol">
<li><a id="orgaa20593"></a>Power spectrum<br>
<div class="outline-text-6" id="text-1-2-0-0-1">
<p>
\(S(\nu) = \Phi(\nu) \Phi^{*}(\nu) = \left| \Phi(\nu) \right|^2\) is
called the power spectrum of the spectral power density (SPD) of \(F(t)\).
This is what an optical spectrometer measures.
</p>


<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">\(F(x)\)</th>
<th scope="col" class="org-left">\(\Phi(p)\)</th>
<th scope="col" class="org-left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">'top-hat' function \(\Pi_a(x)\)</td>
<td class="org-left">\(a~\mathrm{sinc}(\pi p a)\)</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Gaussian \(G(x)=e^{-x^2/a^2}\)</td>
<td class="org-left">\(g(p) = a \sqrt{\pi} e^{-\pi^2a^2p^2}\)</td>
<td class="org-left">\(G(x)\) is a Gausian with width parameter \(a\), while \(g(p)\) has a width parameter \(1/\pi a\).</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">\(f(x) = e^{-x/a} \; (x>0)\)</td>
<td class="org-left">\(\Phi(p) = \frac{-1}{2\pi i p -1/a}\)</td>
<td class="org-left">The power spectrum of \(f(x)\) is a Lorentz profile with a FWHM \(1/\pi a\)</td>
</tr>

<tr>
<td class="org-left">\(\delta(x)\)</td>
<td class="org-left">1</td>
<td class="org-left">"Small is big; big is small." Think about a Gaussian function with unit area.</td>
</tr>
</tbody>
</table>
</div>
</li>
</ol>
</div>

<div id="outline-container-sec:math" class="outline-3">
<h3 id="sec:math"><span class="section-number-3">1.3</span> Fitting functions</h3>
<div class="outline-text-3" id="text-sec:math">
</div>

<div id="outline-container-subsec:fermi" class="outline-4">
<h4 id="subsec:fermi"><span class="section-number-4">1.3.1</span> ArcTan and Sigmoid function</h4>
<div class="outline-text-4" id="text-subsec:fermi">
<p>
The Fermi Function is used to fit the SFE(t) in our project:
\[\label{eq:3}
f(x) = \frac{a}{e^{-(x-\mu)/k} + 1}.\] Its derivative
\(F(x) = \d f(x) / \d x\) has a smilar shape as the Gaussian function. It
peaks at \(x=\mu\) at which \(F(x) = a/4k\). Its Full-Width Half-Maximum
(FWHM) is \(2 \ln(3+2 \sqrt{2}) k \approx
3.525 k\).
</p>

<p>
The \(\arctan\) function \(f(x) = a \arctan(k(x-b))\) has the similar shape
with its derivative having a height of \(a k\) and FWHM of \(2/k\).
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr><p>Author: <a href='https://www.astro.umd.edu/~chongchong/'>Chong-Chong He</a></p><p>Last updated: 2022-04-08</p>
</div>
</body>
</html>
